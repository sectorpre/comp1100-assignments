--- Copyright 2022 The Australian National University, All rights reserved

module Model where

import CodeWorld

data Shape
  -- | The Line constructor holds the start and end coordinates of the line.
  = Line Point Point
  -- | For the Polygon, a list of vertices.
  | Polygon [Point]
  -- | For the Rectangle, coordinates of two opposite vertices.
  --   The rectangle should be drawn with two sides parallel to each of the x and y axes.
  | Rectangle Point Point
  -- | For the Circle, the centrepoint and radius.
  | Circle Point Double
  -- | For the (isosceles right) Triangle,
  --   coordinates of the hypotenuse vertices. 
  | Triangle Point Point
  -- | For the Ellipse, the eccentricity
  -- and the opposite points on the major axis. Note that a circle is
  -- an ellipse with eccentricity 0.
  | Ellipse Double Point Point
  deriving (Show)

type ColourShape = (ColourName, Shape)

data Tool
  = LineTool (Maybe Point)
  | PolygonTool [Point]
  | RectangleTool (Maybe Point)
  | CircleTool (Maybe Point)
  | TriangleTool (Maybe Point)
  | EllipseTool Double (Maybe Point)
  deriving (Eq, Show)

data ColourName
  = Black
  | Pink
  | Red
  | Orange
  | Brown
  | Green
  | Blue
  | White
  deriving (Eq, Show, Enum)

data Model = Model [ColourShape] Tool ColourName
  deriving (Show)

-- | Starting Model for when our Shapes test program first starts up.
startModel :: Model
startModel = Model [] (TriangleTool Nothing) Black

-- | A sample image of a spotty dog on a podium.
sample :: [ColourShape]
sample = [
  -- Podium
  (Orange,Circle (0.30687830687830686,-8.88888888888889) 0.5189502575762632),
  (Green,Triangle (4.772486772486772,-3.947089947089947)
                  (0.3492063492063492,-8.328042328042327)),
  (Blue,Triangle (0.30687830687830686,-8.34920634920635)
                  (-4.074074074074074,-3.8835978835978837)), 
  (Pink,Triangle (4.814814814814815,-3.8835978835978837)
                 (-4.137566137566138,-3.8412698412698414)),
  -- Spots
  (White,Circle (1.746031746031746,2.2645502645502646) 0.18840734195518358),
  (White,Circle (-0.656084656084656,-1.9365079365079365) 0.29421034443297023),
  (White,Circle (1.798941798941799,-2.1164021164021163) 0.22447834323382468),
  (White,Circle (2.2116402116402116,0.8148148148148149) 0.4357938684015662),
  (White,Circle (-2.7724867724867726,2.211640211640212) 0.26707787225659185),
  (White,Circle (-3.9788359788359786,3.322751322751323) 0.12065348413747477),
  (White,Circle (-2.4973544973544977,-0.1164021164021164) 0.27937309592474247),
  (White,Circle (3.1746031746031744e-2,-0.13756613756613756) 0.41093095955444653),
  (White,Circle (0.455026455026455,2.17989417989418) 0.15731289679702126),
  (White,Circle (-1.2698412698412698,1.9365079365079367) 0.3466315207229461),
  (White,Circle (-1.7037037037037037,3.873015873015873) 0.21815373680516723),
  -- Face
  (Black,Line (-8.095238095238095,3.312169312169312) (-8.116402116402117,3.8835978835978837)),
  (Black,Line (-7.523809523809524,3.671957671957672) (-8.074074074074074,3.312169312169312)),
  (Black,Circle (-6.095238095238095,4.37037037037037) 0.17355787795615604),
  (Black,Triangle (-8.116402116402117,3.9047619047619047)
                  (-7.333333333333333,4.708994708994709)),
  -- Head
  (Brown,Polygon [
    (-3.4814814814814814,2.2962962962962963),
    (-5.2592592592592595,3.248677248677249),
    (-8.095238095238095,3.015873015873016),
    (-8.158730158730158,4.6878306878306875),
    (-6.063492063492063,4.8994708994708995),
    (-5.703703703703703,6.232804232804233),
    (-5.343915343915344,4.835978835978836),
    (-5.343915343915344,4.835978835978836),
    (-4.116402116402116,6.042328042328043),
    (-4.4338624338624335,4.772486772486772),
    (-2.9735449735449735,3.8835978835978837)]),
  -- Wagging of tail
  (Red,Line (8.052910052910052,-1.1534391534391535) (6.71957671957672,-2.9735449735449735)),
  (Red,Line (5.28042328042328,-0.43386243386243384) (4.560846560846561,-2.2962962962962963)),
  (Red,Line (5.936507936507937,-0.8359788359788359) (5.08994708994709,-2.232804232804233)),
  (Red,Line (6.571428571428571,-0.9629629629629629) (5.619047619047619,-2.35978835978836)),
  (Red,Line (6.994708994708994,-1.470899470899471) (6.042328042328043,-2.867724867724868)),
  -- Tail
  (Brown,Polygon [
    (3.4814814814814814,-2.613756613756614),
    (3.5873015873015874,-2.7830687830687832),
    (3.9682539682539684,-2.888888888888889),
    (4.243386243386244,-3.015873015873016),
    (4.666666666666667,-3.2063492063492065),
    (5.216931216931217,-3.439153439153439),
    (5.5132275132275135,-3.544973544973545),
    (5.978835978835979,-3.566137566137566),
    (6.317460317460317,-3.6084656084656084),
    (6.317460317460317,-3.6084656084656084),
    (6.338624338624339,-3.439153439153439),
    (6.296296296296297,-3.291005291005291),
    (6.0,-3.164021164021164),
    (5.343915343915344,-3.015873015873016),
    (4.6878306878306875,-2.867724867724868),
    (4.031746031746032,-2.5502645502645502),
    (3.502645502645503,-2.0)]),
  -- Legs
  (Brown,Rectangle (-0.8783068783068783,-3.417989417989418) (9.523809523809523e-2,-3.3333333333333335)),
  (Brown,Rectangle (-0.6878306878306878,-3.925925925925926) (0.8994708994708994,-3.693121693121693)),
  (Brown,Rectangle (-2.6984126984126986,-3.798941798941799) (-2.4021164021164023,-1.0476190476190477)),
  (Brown,Rectangle (-3.693121693121693,-3.8835978835978837) (-3.2698412698412698,0.7724867724867724)),
  -- Body
  (Brown,Ellipse 0.7071067811865476 (2.9735449735449735,-3.2698412698412698) (-2.888888888888889,4.137566137566138))
  ]
